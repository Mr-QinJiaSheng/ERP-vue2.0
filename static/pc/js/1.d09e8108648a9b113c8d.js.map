{"version":3,"sources":["webpack:///static/pc/js/1.d09e8108648a9b113c8d.js","webpack:///./src/views/global/login.vue?fa64","webpack:///login.vue?534f","webpack:///./src/views/global/login.vue?cb59*","webpack:///./src/views/global/login.vue?99d5*","webpack:///./src/views/global/login.vue?60ff*"],"names":["webpackJsonp","556","module","exports","__webpack_require__","injectStyle","ssrContext","Component","564","__webpack_exports__","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default","n","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default","__WEBPACK_IMPORTED_MODULE_2__utils_local_store__","__WEBPACK_IMPORTED_MODULE_3__utils_lazyload__","__WEBPACK_IMPORTED_MODULE_4_vuex__","name","data","logining","winSize","width","height","formOffset","position","left","top","login_actions","disabled","username","password","token","rule_data","validator","rule","callback","Error","test","trigger","computed","i","loadRoutersDone","state","backgroundMenus","created","this","setSize","methods","window","innerWidth","innerHeight","parseInt","onLogin","ref","_this","$refs","validate","valid","params","$ajax","post","then","response","_response$data","code","msg","user","$message","message","type","set","setGlobalUserInfo","groups","_params","isAdmin","IsAdmin","_response$data2","menuList2Json","menus","setGlobalUserMenu","loadBackgroundRouters","$router","push","menuList","resultJson","stepList","menuLen","length","menu","step","ParentRight","ParentLeft","hasStep","j","sort","_j","len","_step","_i","_menu","menuStep","Parent","parentIndex","Index","k","children","path","menusRoutes","addRoutes","setloadRoutersDone","565","version","sources","names","mappings","file","sourcesContent","sourceRoot","566","content","locals","571","render","_vm","_h","$createElement","_c","_self","staticClass","style","attrs","span","label-position","label-width","model","rules","_v","prop","auto-complete","placeholder","$$v","$set","expression","nativeOn","keyup","$event","_k","keyCode","key","on","click","staticRenderFns"],"mappings":"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","file":"static/pc/js/1.d09e8108648a9b113c8d.js","sourcesContent":["webpackJsonp([1],{\n\n/***/ 556:\n/***/ (function(module, exports, __webpack_require__) {\n\nfunction injectStyle (ssrContext) {\n  __webpack_require__(566)\n}\nvar Component = __webpack_require__(211)(\n  /* script */\n  __webpack_require__(564),\n  /* template */\n  __webpack_require__(571),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-2398d4dc\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 564:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__ = __webpack_require__(212);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__ = __webpack_require__(137);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_local_store__ = __webpack_require__(90);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_lazyload__ = __webpack_require__(138);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_vuex__ = __webpack_require__(89);\n\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    name: 'login',\n    data: function data() {\n        return {\n            logining: false,\n            winSize: {\n                width: '',\n                height: ''\n            },\n            formOffset: {\n                position: 'absolute',\n                left: '',\n                top: ''\n            },\n            login_actions: {\n                disabled: false\n            },\n            data: {\n                username: 'admin',\n                password: 'cloudy',\n                token: ''\n            },\n            rule_data: {\n                username: [{\n                    validator: function validator(rule, value, callback) {\n                        if (value === '') {\n                            callback(new Error('请输入用户名'));\n                        } else {\n                            if (/^[a-zA-Z0-9_-]{2,16}$/.test(value)) {\n                                callback();\n                            } else {\n                                callback(new Error('用户名至少6位,由大小写字母和数字,-,_,组成'));\n                            }\n                        }\n                    },\n                    trigger: 'blur'\n                }],\n                password: [{\n                    validator: function validator(rule, value, callback) {\n                        if (value === '') {\n                            callback(new Error('请输入密码'));\n                        } else {\n                            if (!/^[a-zA-Z0-9_-]{6,16}$/.test(value)) {\n                                callback(new Error('密码至少6位,由大小写字母和数字,-,_组成'));\n                            } else {\n                                callback();\n                            }\n                        }\n                    },\n                    trigger: 'blur'\n                }]\n            }\n        };\n    },\n\n    computed: __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({}, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4_vuex__[\"b\" /* mapState */])({\n        loadRoutersDone: function loadRoutersDone(state) {\n            return state.loadRoutersDone;\n        },\n        backgroundMenus: function backgroundMenus(state) {\n            return state.backgroundMenus;\n        }\n    })),\n    created: function created() {\n        this.setSize();\n    },\n\n    methods: __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({\n        // 设置窗口大小\n        setSize: function setSize() {\n            this.winSize.width = window.innerWidth + 'px';\n            this.winSize.height = window.innerHeight + 'px';\n            this.formOffset.left = parseInt(this.winSize.width) / 2 - 175 + 'px';\n            this.formOffset.top = parseInt(this.winSize.height) / 2 - 178 + 'px';\n        },\n        onLogin: function onLogin(ref) {\n            var _this = this;\n\n            this.$refs[ref].validate(function (valid) {\n                if (valid) {\n                    _this.logining = true;\n                    var params = {\n                        username: _this.data.username,\n                        password: _this.data.password\n                    };\n                    _this.$ajax.post('/login', params).then(function (response) {\n                        _this.logining = false;\n                        var _response$data = response.data,\n                            code = _response$data.code,\n                            msg = _response$data.msg,\n                            data = _response$data.data;\n\n                        if (code == 'success') {\n                            var user = data.user;\n                            //提示\n                            _this.$message({ message: msg, type: 'success' });\n                            // 本地缓存用户信息\n                            __WEBPACK_IMPORTED_MODULE_2__utils_local_store__[\"a\" /* default */].set('userinfo', __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(user));\n                            //更新store中的userinfo\n                            _this.setGlobalUserInfo(user);\n                            // 本地缓存权限信息\n                            __WEBPACK_IMPORTED_MODULE_2__utils_local_store__[\"a\" /* default */].set('groups', __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(data.groups));\n                            // 验证通过，获得菜单\n                            var _params = {\n                                groups: data.groups,\n                                isAdmin: user.IsAdmin\n                            };\n                            _this.$ajax.post(\"/menu\", _params).then(function (response) {\n                                var _response$data2 = response.data,\n                                    code = _response$data2.code,\n                                    msg = _response$data2.msg,\n                                    data = _response$data2.data;\n\n                                if (code == 'success') {\n                                    // 后台菜单\n                                    var backgroundMenus = _this.menuList2Json(data.menus);\n                                    // 本地缓存后台菜单信息\n                                    __WEBPACK_IMPORTED_MODULE_2__utils_local_store__[\"a\" /* default */].set('backgroundMenus', __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(backgroundMenus));\n                                    _this.setGlobalUserMenu(backgroundMenus);\n                                    _this.loadBackgroundRouters();\n                                } else {\n                                    _this.$message({ message: msg, type: 'error' });\n                                }\n                                //登录成功跳转到后台首页\n                                _this.$router.push('/');\n                            });\n                        } else {\n                            _this.$message({ message: msg, type: 'error' });\n                        }\n                    });\n                }\n            });\n        },\n        menuList2Json: function menuList2Json(menuList) {\n            // 后台\n            var resultJson = [];\n\n            var stepList = [];\n            if (menuList == null) {\n                return resultJson;\n            }\n            var menuLen = menuList.length;\n            // 获得所有的步长,以及顶级才按\n            for (var i = 0; i < menuLen; i++) {\n                var menu = menuList[i];\n                var step = menu.ParentRight - menu.ParentLeft;\n                var hasStep = false;\n                for (var j = 0; j < stepList.length; j++) {\n                    if (step == stepList[j]) {\n                        hasStep = true;\n                    }\n                }\n                if (hasStep == false) {\n                    stepList.push(step);\n                }\n            }\n            // 对stepList排序\n            stepList.sort();\n            //循环处理menu,后期考虑删除已经处理的元素\n            for (var _j = 0, len = stepList.length; _j < len; _j++) {\n                var _step = stepList[_j];\n                for (var _i = 0; _i < menuLen; _i++) {\n                    var _menu = menuList[_i];\n                    var menuStep = _menu.ParentRight - _menu.ParentLeft;\n                    // 若不相等跳过\n                    if (_step != menuStep) {\n                        continue;\n                    }\n                    //排除顶级菜单\n                    if (_menu.Parent != null) {\n                        var parentIndex = _menu.Parent.Index;\n                        for (var k = 0; k < menuLen; k++) {\n                            if (menuList[k].Index == parentIndex) {\n                                if (!(\"children\" in menuList[k])) {\n                                    menuList[k].children = [];\n                                }\n                                delete _menu.Parent;\n                                delete _menu.ParentLeft;\n                                delete _menu.ParentRight;\n                                // 增加path前缀，即地址为绝对地址\n                                _menu.path = '/' + _menu.path;\n                                menuList[k].children.push(_menu);\n                            }\n                        }\n                    } else {\n                        delete _menu.Parent;\n                        delete _menu.ParentLeft;\n                        delete _menu.ParentRight;\n                        // 增加path前缀，即地址为绝对地址\n                        _menu.path = '/' + _menu.path;\n                        resultJson.push(_menu);\n                    }\n                }\n            }\n\n            return resultJson;\n        },\n        loadBackgroundRouters: function loadBackgroundRouters() {\n            if (this.loadRoutersDone == false) {\n                var menusRoutes = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3__utils_lazyload__[\"a\" /* default */])(this.backgroundMenus);\n                this.$router.addRoutes([menusRoutes]);\n                //动态加载路由\n                this.setloadRoutersDone(true);\n            }\n        }\n    }, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4_vuex__[\"c\" /* mapMutations */])({\n        setGlobalUserInfo: \"GLOBAL_SET_USERINFO\",\n        setGlobalUserMenu: \"GLOBAL_SET_UER_MENUS\",\n        setloadRoutersDone: \"GLOBAL_LOAD_ROUTES_DONE\"\n    }))\n\n});\n\n/***/ }),\n\n/***/ 565:\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(554)(true);\n// imports\n\n\n// module\nexports.push([module.i, \".login[data-v-2398d4dc]{background:#1f2d3d}.login .loginform[data-v-2398d4dc]{box-shadow:0 0 8px 0 rgba(0,0,0,.06),0 1px 0 0 rgba(0,0,0,.02);border-radius:5px;-moz-border-radius:5px;background-clip:padding-box;margin-bottom:3rem;background-color:#f9fafc;border:2px solid #8492a6}.login .title[data-v-2398d4dc]{margin:0 auto 40px;text-align:center;color:red;font-weight:400;font-size:2rem}.login .title span[data-v-2398d4dc]{cursor:pointer}.login .title span.active[data-v-2398d4dc]{font-weight:700;font-size:18px}.login .loginform[data-v-2398d4dc]{width:350px;padding:35px 35px 15px}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloudy/Documents/go/src/goERP/web_pc/src/views/global/login.vue\"],\"names\":[],\"mappings\":\"AACA,wBACE,kBAAoB,CACrB,AACD,mCACI,+DAA6E,AAC7E,kBAAmB,AACnB,uBAAwB,AACxB,4BAA6B,AAC7B,mBAAoB,AACpB,yBAA0B,AAC1B,wBAA0B,CAC7B,AACD,+BACI,mBAA2B,AAC3B,kBAAmB,AACnB,UAAW,AACX,gBAAoB,AACpB,cAAgB,CACnB,AACD,oCACM,cAAgB,CACrB,AACD,2CACQ,gBAAkB,AAClB,cAAgB,CACvB,AACD,mCACI,YAAa,AACb,sBAA6B,CAChC\",\"file\":\"login.vue\",\"sourcesContent\":[\"\\n.login[data-v-2398d4dc] {\\n  background: #1F2D3D;\\n}\\n.login .loginform[data-v-2398d4dc] {\\n    box-shadow: 0 0px 8px 0 rgba(0, 0, 0, 0.06), 0 1px 0px 0 rgba(0, 0, 0, 0.02);\\n    border-radius: 5px;\\n    -moz-border-radius: 5px;\\n    background-clip: padding-box;\\n    margin-bottom: 3rem;\\n    background-color: #F9FAFC;\\n    border: 2px solid #8492A6;\\n}\\n.login .title[data-v-2398d4dc] {\\n    margin: 0px auto 40px auto;\\n    text-align: center;\\n    color: red;\\n    font-weight: normal;\\n    font-size: 2rem;\\n}\\n.login .title span[data-v-2398d4dc] {\\n      cursor: pointer;\\n}\\n.login .title span.active[data-v-2398d4dc] {\\n        font-weight: bold;\\n        font-size: 18px;\\n}\\n.login .loginform[data-v-2398d4dc] {\\n    width: 350px;\\n    padding: 35px 35px 15px 35px;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n/***/ }),\n\n/***/ 566:\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(565);\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(555)(\"6d77b83c\", content, true, {});\n\n/***/ }),\n\n/***/ 571:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"login\",\n    style: (_vm.winSize)\n  }, [_c('el-row', [_c('el-col', {\n    attrs: {\n      \"span\": 24\n    }\n  }, [_c('div', {\n    staticClass: \"content\"\n  }, [_c('el-form', {\n    ref: \"loginData\",\n    staticClass: \"loginform\",\n    style: (_vm.formOffset),\n    attrs: {\n      \"label-position\": \"left\",\n      \"label-width\": \"0px\",\n      \"model\": _vm.data,\n      \"rules\": _vm.rule_data\n    }\n  }, [_c('h3', {\n    staticClass: \"title\"\n  }, [_c('span', [_vm._v(\"系统登录\")])]), _vm._v(\" \"), _c('el-form-item', {\n    attrs: {\n      \"prop\": \"username\"\n    }\n  }, [_c('el-input', {\n    attrs: {\n      \"type\": \"text\",\n      \"auto-complete\": \"off\",\n      \"placeholder\": \"请输入账号\"\n    },\n    model: {\n      value: (_vm.data.username),\n      callback: function($$v) {\n        _vm.$set(_vm.data, \"username\", $$v)\n      },\n      expression: \"data.username\"\n    }\n  })], 1), _vm._v(\" \"), _c('el-form-item', {\n    attrs: {\n      \"prop\": \"password\"\n    }\n  }, [_c('el-input', {\n    attrs: {\n      \"type\": \"password\",\n      \"auto-complete\": \"off\",\n      \"placeholder\": \"请输入密码\"\n    },\n    nativeOn: {\n      \"keyup\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13, $event.key)) { return null; }\n        _vm.onLogin('loginData')\n      }\n    },\n    model: {\n      value: (_vm.data.password),\n      callback: function($$v) {\n        _vm.$set(_vm.data, \"password\", $$v)\n      },\n      expression: \"data.password\"\n    }\n  })], 1), _vm._v(\" \"), _c('el-form-item', [_c('el-button', {\n    attrs: {\n      \"type\": \"primary\"\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.onLogin(\"loginData\")\n      }\n    }\n  }, [_vm._v(\"登录\")])], 1)], 1)], 1)])], 1)], 1)\n},staticRenderFns: []}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/pc/js/1.d09e8108648a9b113c8d.js","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2398d4dc\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./login.vue\")\n}\nvar Component = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./login.vue\"),\n  /* template */\n  require(\"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2398d4dc\\\",\\\"hasScoped\\\":true}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./login.vue\"),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-2398d4dc\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/global/login.vue\n// module id = 556\n// module chunks = 0 1","<template>\n    <div class=\"login\" :style=\"winSize\">\n        <el-row>\n            <el-col :span=\"24\">\n                <div class=\"content\">\n                    <el-form label-position=\"left\" label-width=\"0px\" class=\"loginform\" \n                    :style=\"formOffset\"\n                    :model='data'\n                    :rules=\"rule_data\"\n                    ref='loginData'>\n                        <h3 class=\"title\"> <span>系统登录</span></h3>\n                        <el-form-item\n                                prop='username'>\n                            <el-input type=\"text\" auto-complete=\"off\" placeholder=\"请输入账号\"\n                                      v-model='data.username'></el-input>\n                        </el-form-item>\n\n                        <el-form-item\n                                prop='password'>\n                            <el-input type=\"password\" auto-complete=\"off\" placeholder=\"请输入密码\"\n                                      v-model='data.password'\n                                      @keyup.native.enter=\"onLogin('loginData')\"></el-input>\n                        </el-form-item>\n                        <el-form-item>\n                            <el-button type=\"primary\" @click='onLogin(\"loginData\")'>登录</el-button>\n                        </el-form-item>\n                    </el-form>\n                </div>\n            </el-col>\n        </el-row>\n    </div>\n</template>\n<script>\n    import localStore from '@/utils/local_store';\n    import lazyLoadMenusRoutes from '@/utils/lazyload';\n    import { mapMutations } from 'vuex';\n    import { mapState } from 'vuex';\n\n    export default {\n        name: 'login',\n        data() {\n            return {\n                logining:false,\n                winSize: {\n                    width: '',\n                    height: ''\n                },\n                formOffset: {\n                    position: 'absolute',\n                    left: '',\n                    top: ''\n                },\n                login_actions: {\n                    disabled: false\n                },\n                data: {\n                    username: 'admin',\n                    password: 'cloudy',\n                    token: ''\n                },\n                rule_data:{\n                    username: [{\n                        validator:(rule, value, callback)=>{\n                            if (value === '') {\n                                callback(new Error('请输入用户名'));\n                            } else {\n                                if(/^[a-zA-Z0-9_-]{2,16}$/.test(value)){\n                                    callback();\n                                }else{\n                                    callback(new Error('用户名至少6位,由大小写字母和数字,-,_,组成'));\n                                }\n                            }\n                        },\n                        trigger: 'blur'\n                    }],\n                    password: [{\n                        validator:(rule, value, callback)=>{\n                            if (value === '') {\n                                callback(new Error('请输入密码'));\n                            } else {\n                                if(!(/^[a-zA-Z0-9_-]{6,16}$/.test(value))){\n                                    callback(new Error('密码至少6位,由大小写字母和数字,-,_组成'));\n                                }else{\n                                    callback();\n                                }\n\n                            }\n                        },\n                        trigger: 'blur'\n                    }]\n                },\n            }\n        },\n        computed:{\n           ...mapState({\n               loadRoutersDone: state => state.loadRoutersDone,\n               backgroundMenus: state => state.backgroundMenus\n            })\n        },\n        created() {\n            this.setSize();\n        },\n        methods: {\n            // 设置窗口大小\n            setSize() {\n                this.winSize.width = window.innerWidth + 'px';\n                this.winSize.height = window.innerHeight +'px' ;\n                this.formOffset.left = (parseInt(this.winSize.width) / 2 - 175) + 'px';\n                this.formOffset.top = (parseInt(this.winSize.height) / 2 - 178) + 'px';\n            },\n            onLogin(ref){\n                this.$refs[ref].validate((valid)=>{\n                    if(valid){\n                        this.logining = true;\n                        let params = {\n                            username: this.data.username,\n                            password: this.data.password\n                        };\n                        this.$ajax.post('/login',params).then(response=>{\n                            this.logining = false;\n                            let {code,msg,data} = response.data;\n                            if (code=='success'){\n                                let user = data.user;\n                                //提示\n                                this.$message({ message:msg, type: 'success' });\n                                // 本地缓存用户信息\n                                localStore.set('userinfo',JSON.stringify(user));\n                                //更新store中的userinfo\n                                this.setGlobalUserInfo(user)\n                                // 本地缓存权限信息\n                                localStore.set('groups',JSON.stringify(data.groups));\n                                // 验证通过，获得菜单\n                                let params = {\n                                    groups:data.groups,\n                                    isAdmin:user.IsAdmin,\n                                }\n                                this.$ajax.post(\"/menu\",params).then(response=>{\n                                    let {code,msg,data} = response.data;\n                                    if(code=='success'){\n                                        // 后台菜单\n                                        let backgroundMenus = this.menuList2Json(data.menus);\n                                        // 本地缓存后台菜单信息\n                                        localStore.set('backgroundMenus',JSON.stringify(backgroundMenus));\n                                        this.setGlobalUserMenu(backgroundMenus);\n                                        this.loadBackgroundRouters();\n                                    }else{\n                                        this.$message({  message:msg,   type: 'error' });\n                                    }\n                                    //登录成功跳转到后台首页\n                                    this.$router.push('/');\n                                });\n                            }else{\n                                this.$message({  message:msg,   type: 'error' });\n                            }\n                        });\n                    }\n                });\n            },\n            menuList2Json(menuList){\n                // 后台\n                let resultJson =[];\n               \n                let stepList = [];\n                if (menuList== null){\n                    return resultJson;\n                }\n                let  menuLen = menuList.length;\n                // 获得所有的步长,以及顶级才按\n                for( let i=0;i<menuLen;i++){\n                    let menu  = menuList[i];\n                    let step = menu.ParentRight - menu.ParentLeft;\n                    let hasStep = false;\n                    for(let j=0;j<stepList.length;j++){\n                        if (step==stepList[j]){\n                            hasStep = true;\n                        }\n                    }\n                    if (hasStep==false){\n                        stepList.push(step);\n                    }\n                }\n                // 对stepList排序\n                stepList.sort();\n                //循环处理menu,后期考虑删除已经处理的元素\n                for(let j=0,len=stepList.length;j<len;j++){\n                    let step = stepList[j];\n                    for(let i=0;i<menuLen;i++){\n                        let menu = menuList[i];\n                        let menuStep = menu.ParentRight - menu.ParentLeft;\n                        // 若不相等跳过\n                        if (step!=menuStep){\n                            continue\n                        }\n                        //排除顶级菜单\n                        if (menu.Parent != null){\n                            let parentIndex = menu.Parent.Index;\n                            for(let k=0; k<menuLen;k++){\n                                if (menuList[k].Index == parentIndex){\n                                    if(!(\"children\" in menuList[k])){\n                                        menuList[k].children = [];\n                                    } \n                                    delete menu.Parent;\n                                    delete menu.ParentLeft;\n                                    delete menu.ParentRight;\n                                    // 增加path前缀，即地址为绝对地址\n                                    menu.path = '/' +menu.path;\n                                    menuList[k].children.push(menu);\n                                }\n                            }\n                        }else{\n                            delete menu.Parent;\n                            delete menu.ParentLeft;\n                            delete menu.ParentRight;\n                            // 增加path前缀，即地址为绝对地址\n                            menu.path = '/' +menu.path;\n                            resultJson.push(menu)\n                        }\n                    }\n                }\n                 \n                return resultJson;\n            },\n            loadBackgroundRouters(){\n                if (this.loadRoutersDone==false){\n                    let menusRoutes = lazyLoadMenusRoutes(this.backgroundMenus);\n                    this.$router.addRoutes([menusRoutes]);\n                    //动态加载路由\n                    this.setloadRoutersDone(true);\n                }\n            },\n            ...mapMutations({\n                setGlobalUserInfo: \"GLOBAL_SET_USERINFO\",\n                setGlobalUserMenu: \"GLOBAL_SET_UER_MENUS\",\n                setloadRoutersDone: \"GLOBAL_LOAD_ROUTES_DONE\"\n            })\n        }\n        \n        \n    }\n</script>\n<style lang=\"scss\" scoped>\n.login {\n    background : #1F2D3D;\n\n    .loginform {\n        box-shadow            : 0 0px 8px 0 rgba(0, 0, 0, 0.06), 0 1px 0px 0 rgba(0, 0, 0, 0.02);\n        -webkit-border-radius : 5px;\n        border-radius         : 5px;\n        -moz-border-radius    : 5px;\n        background-clip       : padding-box;\n        margin-bottom         : 3rem;\n        background-color      : #F9FAFC;\n        border                : 2px solid #8492A6;\n    }\n\n    .title {\n        margin      : 0px auto 40px auto;\n        text-align  : center;\n        color       : red;\n        font-weight : normal;\n        font-size   : 2rem;\n\n        span {\n            cursor : pointer;\n\n            &.active {\n                font-weight : bold;\n                font-size   : 18px;\n            }\n        }\n    }\n\n    .loginform {\n        width   : 350px;\n        padding : 35px 35px 15px 35px;\n    }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// login.vue?6b1f5821","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".login[data-v-2398d4dc]{background:#1f2d3d}.login .loginform[data-v-2398d4dc]{box-shadow:0 0 8px 0 rgba(0,0,0,.06),0 1px 0 0 rgba(0,0,0,.02);border-radius:5px;-moz-border-radius:5px;background-clip:padding-box;margin-bottom:3rem;background-color:#f9fafc;border:2px solid #8492a6}.login .title[data-v-2398d4dc]{margin:0 auto 40px;text-align:center;color:red;font-weight:400;font-size:2rem}.login .title span[data-v-2398d4dc]{cursor:pointer}.login .title span.active[data-v-2398d4dc]{font-weight:700;font-size:18px}.login .loginform[data-v-2398d4dc]{width:350px;padding:35px 35px 15px}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloudy/Documents/go/src/goERP/web_pc/src/views/global/login.vue\"],\"names\":[],\"mappings\":\"AACA,wBACE,kBAAoB,CACrB,AACD,mCACI,+DAA6E,AAC7E,kBAAmB,AACnB,uBAAwB,AACxB,4BAA6B,AAC7B,mBAAoB,AACpB,yBAA0B,AAC1B,wBAA0B,CAC7B,AACD,+BACI,mBAA2B,AAC3B,kBAAmB,AACnB,UAAW,AACX,gBAAoB,AACpB,cAAgB,CACnB,AACD,oCACM,cAAgB,CACrB,AACD,2CACQ,gBAAkB,AAClB,cAAgB,CACvB,AACD,mCACI,YAAa,AACb,sBAA6B,CAChC\",\"file\":\"login.vue\",\"sourcesContent\":[\"\\n.login[data-v-2398d4dc] {\\n  background: #1F2D3D;\\n}\\n.login .loginform[data-v-2398d4dc] {\\n    box-shadow: 0 0px 8px 0 rgba(0, 0, 0, 0.06), 0 1px 0px 0 rgba(0, 0, 0, 0.02);\\n    border-radius: 5px;\\n    -moz-border-radius: 5px;\\n    background-clip: padding-box;\\n    margin-bottom: 3rem;\\n    background-color: #F9FAFC;\\n    border: 2px solid #8492A6;\\n}\\n.login .title[data-v-2398d4dc] {\\n    margin: 0px auto 40px auto;\\n    text-align: center;\\n    color: red;\\n    font-weight: normal;\\n    font-size: 2rem;\\n}\\n.login .title span[data-v-2398d4dc] {\\n      cursor: pointer;\\n}\\n.login .title span.active[data-v-2398d4dc] {\\n        font-weight: bold;\\n        font-size: 18px;\\n}\\n.login .loginform[data-v-2398d4dc] {\\n    width: 350px;\\n    padding: 35px 35px 15px 35px;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-2398d4dc\",\"scoped\":true,\"hasInlineConfig\":false}!./~/sass-loader/lib/loader.js?{\"sourceMap\":true}!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/views/global/login.vue\n// module id = 565\n// module chunks = 0 1","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2398d4dc\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/sass-loader/lib/loader.js?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./login.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"6d77b83c\", content, true, {});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/extract-text-webpack-plugin/loader.js?{\"omit\":1,\"remove\":true}!./~/vue-style-loader!./~/css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-2398d4dc\",\"scoped\":true,\"hasInlineConfig\":false}!./~/sass-loader/lib/loader.js?{\"sourceMap\":true}!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/views/global/login.vue\n// module id = 566\n// module chunks = 0 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"login\",\n    style: (_vm.winSize)\n  }, [_c('el-row', [_c('el-col', {\n    attrs: {\n      \"span\": 24\n    }\n  }, [_c('div', {\n    staticClass: \"content\"\n  }, [_c('el-form', {\n    ref: \"loginData\",\n    staticClass: \"loginform\",\n    style: (_vm.formOffset),\n    attrs: {\n      \"label-position\": \"left\",\n      \"label-width\": \"0px\",\n      \"model\": _vm.data,\n      \"rules\": _vm.rule_data\n    }\n  }, [_c('h3', {\n    staticClass: \"title\"\n  }, [_c('span', [_vm._v(\"系统登录\")])]), _vm._v(\" \"), _c('el-form-item', {\n    attrs: {\n      \"prop\": \"username\"\n    }\n  }, [_c('el-input', {\n    attrs: {\n      \"type\": \"text\",\n      \"auto-complete\": \"off\",\n      \"placeholder\": \"请输入账号\"\n    },\n    model: {\n      value: (_vm.data.username),\n      callback: function($$v) {\n        _vm.$set(_vm.data, \"username\", $$v)\n      },\n      expression: \"data.username\"\n    }\n  })], 1), _vm._v(\" \"), _c('el-form-item', {\n    attrs: {\n      \"prop\": \"password\"\n    }\n  }, [_c('el-input', {\n    attrs: {\n      \"type\": \"password\",\n      \"auto-complete\": \"off\",\n      \"placeholder\": \"请输入密码\"\n    },\n    nativeOn: {\n      \"keyup\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13, $event.key)) { return null; }\n        _vm.onLogin('loginData')\n      }\n    },\n    model: {\n      value: (_vm.data.password),\n      callback: function($$v) {\n        _vm.$set(_vm.data, \"password\", $$v)\n      },\n      expression: \"data.password\"\n    }\n  })], 1), _vm._v(\" \"), _c('el-form-item', [_c('el-button', {\n    attrs: {\n      \"type\": \"primary\"\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.onLogin(\"loginData\")\n      }\n    }\n  }, [_vm._v(\"登录\")])], 1)], 1)], 1)])], 1)], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-2398d4dc\",\"hasScoped\":true}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/views/global/login.vue\n// module id = 571\n// module chunks = 0 1"],"sourceRoot":""}